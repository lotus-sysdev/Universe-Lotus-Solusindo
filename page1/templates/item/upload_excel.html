<!-- upload_csv.html -->
{% extends 'base.html' %} {% block title %}Upload Excel{% endblock %} 
{% block content %}
<h2>Upload Excel File</h2>
<div>
  {% if error_message %}
  <div class="alert alert-danger" role="alert">{{error_message}}</div>
  {% endif %}
  <p>Please note that the Excel format should be:</p>
  <table class="table table-striped table-bordered table-responsive-lg">
    <thead class="thead-light">
      <tr>
        <th>nama</th>
        <th>catatan</th>
        <th>category</th>
        <th>quantity</th>
        <th>unit</th>
        <th>price</th>
        <th>price_currency</th>
        <th>gambar</th>
        <th>tanggal_pemesanan</th>
        <th>customer</th>
        <th>pic</th>
        <th>jenis_sumber</th>
        <th>nama_sumber</th>
        <th>telp_sumber</th>
        <th>email_sumber</th>
        <th>link</th>
      </tr>
    </thead>
    <tbody>
      <tr class="">
        <td>Item Name</td>
        <td>Catatan....</td>
        <td>
          Kategori (Electronics,...) kategori yang sudah ada di <span class="h6">category</span>
        </td>
        <td>1, 2, 3, ...</td>
        <td>Unit, Box, Pcs, ...</td>
        <td>100000000 (tidak usah menggunakan titik atau koma)</td>
        <td>IDR, USD, SGD, dll</td>
        <td>image</td>
        <td>2024-03-27 (yyyy-mm-dd)</td>
        <td>Nama Customer</td>
        <td>Nama PIC</td>
        <td>Jenis Sumber</td>
        <td>Nama Sumber</td>
        <td>No Telp sumber (use +628... or 08...)</td>
        <td>Email Sumber</td>
        <td>Link sumber</td>
      </tr>
    </tbody>
  </table>
  <hr />
  <span class="h4">Note:</span>
  <p>
    Judul kolom harus memiliki <span class="h5">nama yang sama</span> tanpa spasi atau kapitalisasi.
  </p>
  <p>Tambahkan <span class="h5">price_currency</span> untuk menggunakan mata uang khusus.</p>
  <p>
    <span class="h5">price_currency</span> harus terdiri dari 3 digit kode mata uang negara (IDR, USD, SGD, etc.)
  </p>
  <p>Tambahkan <span class="h5">jenis_sumber, nama_sumber, telp_sumber, atau email_sumber</span> untuk menspesifikasikan sumber.</p>
  <p class="h5">Pilih salah satu kategori ini untuk kategori/satuan/customer/jenis sumber</p>

  <div class="col md-12">
    <div class="row">
      <div class="col-md-2">
        <p>Categories:</p>
        <div class="dropdown">
          <button
            class="btn btn-info dropdown-toggle"
            type="button"
            id="categoryDropdown"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
          >
            Pilihan Kategori
          </button>
          <div class="dropdown-menu" aria-labelledby="categoryDropdown">
            {% for category in categories %}
            <a class="dropdown-item" href="#">{{ category.name }}</a>
            {% endfor %}
          </div>
        </div>
      </div>
      <div class="col-md-2">
        <p>Units:</p>
        <div class="dropdown">
          <button
            class="btn btn-secondary dropdown-toggle"
            type="button"
            id="unitDropdown"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
          >
            Pilihan Satuan
          </button>
          <div class="dropdown-menu" aria-labelledby="unitDropdown">
            <a class="dropdown-item" href="#">Botol</a>
            <a class="dropdown-item" href="#">Box</a>
            <a class="dropdown-item" href="#">Bulan</a>
            <a class="dropdown-item" href="#">Dirigen</a>
            <a class="dropdown-item" href="#">Item</a>
            <a class="dropdown-item" href="#">Kaleng</a>
            <a class="dropdown-item" href="#">Kg</a>
            <a class="dropdown-item" href="#">Lusin</a>
            <a class="dropdown-item" href="#">Meter</a>
            <a class="dropdown-item" href="#">Orang</a>
            <a class="dropdown-item" href="#">Pack</a>
            <a class="dropdown-item" href="#">Pail (Cat)</a>
            <a class="dropdown-item" href="#">Pair</a>
            <a class="dropdown-item" href="#">Pcs</a>
            <a class="dropdown-item" href="#">Unit</a>
            <a class="dropdown-item" href="#">Rim</a>
            <a class="dropdown-item" href="#">Roll</a>
            <a class="dropdown-item" href="#">Set</a>
            <a class="dropdown-item" href="#">Lembar</a>
            <a class="dropdown-item" href="#">Galon</a>
            <a class="dropdown-item" href="#">Lainnya</a>
          </div>
        </div>
      </div>
      <div class="col-md-2">
        <p>Customers:</p>
        <div class="dropdown">
          <button
            class="btn btn-success dropdown-toggle"
            type="button"
            id="customerDropdown"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
          >
            Pilihan Customer
          </button>
          <div class="dropdown-menu" aria-labelledby="customerDropdown">
            {% for customer in customers %}
            <a class="dropdown-item" href="#">{{ customer.nama_pt }}</a>
            {% endfor %}
          </div>
        </div>
      </div>
      <div class="col-md-2">
        <p>Jenis Sumber:</p>
        <div class="dropdown">
          <button
            class="btn btn-warning dropdown-toggle"
            type="button"
            id="customerDropdown"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
          >
          Pilihan Jenis Sumber
          </button>
          <div class="dropdown-menu" aria-labelledby="customerDropdown">
            <a class="dropdown-item" href="#">Online Store</a>
            <a class="dropdown-item" href="#">Pabrik</a>
            <a class="dropdown-item" href="#">Reseller</a>
            <a class="dropdown-item" href="#">Grosir</a>
          </div>
        </div>
      </div>
      <div class="col-md-2">
        <p>PIC:</p>
        <div class="dropdown">
          <button
            class="btn btn-primary dropdown-toggle"
            type="button"
            id="customerDropdown"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
          >
            Pilihan PIC
          </button>
          <div class="dropdown-menu" aria-labelledby="customerDropdown">
            {% for pic in customerPIC %}
            <a class="dropdown-item" href="#">{{ pic.nama }} - {{ pic.customer_id }}</a>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
  <hr />
  <form
    class="w-50 form-group mt-3"
    method="post"
    enctype="multipart/form-data"
  >
    {% csrf_token %} {{ form }}
    <div class="mt-3">
      <button type="submit" class="btn btn-primary">Upload</button>
    </div>
  </form>
  <hr />
  <h3 class="mt-3">Processed Items</h3>
  <table class="table table-striped table-bordered table-responsive-lg">
    <thead class="thead-light">
      <tr>
        <th>Nama</th>
        <th>Catatan</th>
        <th>Category</th>
        <th>Quantity</th>
        <th>Unit</th>
        <th>Price</th>
        <th>Price Currency</th>
        <th>Gambar</th>
        <th>Tanggal Pesan</th>
        <th>Customer</th>
        <th>Link</th>
        <th>PIC</th>
      </tr>
    </thead>
    <tbody>
      {% for item in processed_items %}
      <tr>
        <td>{{ item.instance.nama }}</td>
        <td>{{ item.instance.catatan }}</td>
        <td>{{ item.instance.category }}</td>
        <td>{{ item.instance.quantity }}</td>
        <td>{{ item.instance.unit }}</td>
        <td>{{ item.instance.price }}</td>
        <td>{{ item.instance.price_currency }}</td>
        <!-- Display image if available -->
        <td>
          {% if item.instance.gambar %}
          <img src="{{ item.instance.gambar.url }}" width="100" height="100" />
          {% else %} No image available {% endif %}
        </td>
        <td>{{ item.instance.tanggal_pemesanan }}</td>
        <td>{{ item.instance.customer }}</td>
        <td>{{ item.url }}</td>
        <td>{{ item.instance.pic }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% endblock %}
</div>
